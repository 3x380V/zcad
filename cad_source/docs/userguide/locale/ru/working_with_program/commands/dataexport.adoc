
#### DataExport

:cmdcommand: DataExport
:cmdexample: DataExport

include::../../_elements/commandsummary.adoc[]


Команда экспорта параметров графических примитивов в внешний файл CSV. Команда применяет к всем примитивам
текущего чертежа фильтр типа примитивов, передавая на дальнейшую обработку тольк примитивы определенного
типа. Далее применяется фильтр свойств примитивов, оставляя только примитивы имеющие требуемве свойства.
Над прошедшими фильтрацию примитивами выполняется скрипт экспорта записывая требуемые параметры во внешний
файл

При запуске подсказка командной строки принимает вид:

[graphviz, generated/cmdprompt_dataexport, svg]
----
digraph g {
node [shape=plaintext,height=.1];    
node0 [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
                <TR>
                    <TD>Configure export</TD>
                    <TD PORT="f0" BGCOLOR="gray">
                        <TABLE CELLPADDING="0" BORDER="0" CELLSPACING="0">
                            <TR>
                                <TD><FONT COLOR="red"><U>p</U></FONT>aram,</TD>
                            </TR>
                        </TABLE>
                    </TD>
                    <TD>run</TD>                               
                    <TD PORT="f1" BGCOLOR="gray">
                        <TABLE CELLPADDING="0" BORDER="0" CELLSPACING="0">
						    <TR>
							    <TD><FONT COLOR="red"><U>f</U></FONT>ile dialog</TD>
						    </TR>
                        </TABLE>                    
                    </TD>
                    
                    <TD> or enter file name (empty for default): &gt; (1)</TD>
                </TR>
            </TABLE>>]
node1 [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
                <TR>
                    <TD PORT="f0" BGCOLOR="gray">&lt;&lt;&lt;</TD>
                    <TD>Set</TD>
                    <TD PORT="f1" BGCOLOR="gray">
                        <TABLE CELLPADDING="0" BORDER="0" CELLSPACING="0">
                            <TR>
                                <TD><FONT COLOR="red"><U>e</U></FONT>ntities</TD>
                            </TR>
                        </TABLE>                    
                    </TD>
                    <TD>/</TD>
                    <TD PORT="f2" BGCOLOR="gray">
                        <TABLE CELLPADDING="0" BORDER="0" CELLSPACING="0">
                            <TR>
                                <TD><FONT COLOR="red"><U>p</U></FONT>roperties</TD>
                            </TR>
                        </TABLE>                    
                    </TD>
                    <TD>filter or export</TD>
                    <TD PORT="f3" BGCOLOR="gray">
                        <TABLE CELLPADDING="0" BORDER="0" CELLSPACING="0">
                            <TR>
                                <TD><FONT COLOR="red"><U>s</U></FONT>cript</TD>
                            </TR>
                        </TABLE>                    
                    </TD>
                </TR>
            </TABLE>>]
node2 [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
                           <TR>
                               <TD PORT="f0" BGCOLOR="gray">&lt;&lt;&lt;</TD>
                               <TD PORT="f1">Enter new entities filter: &gt; (2)</TD>
                            </TR>
              </TABLE>>]
node3 [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
                           <TR>
                               <TD PORT="f0" BGCOLOR="gray">&lt;&lt;&lt;</TD>
                               <TD PORT="f1">Enter new properties filter: &gt; (3)</TD>
                            </TR>
              </TABLE>>]
node4 [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
                           <TR>
                               <TD PORT="f0" BGCOLOR="gray">&lt;&lt;&lt;</TD>
                               <TD PORT="f1">Enter new export script: &gt; (4)</TD>
                            </TR>
              </TABLE>>]
node5 [label = "File select dialog (5)" shape=record];
"node0":f0 -> "node1"
"node0":f1 -> "node5":f0
"node1":f1 -> "node2":f1
"node1":f2 -> "node3":f1
"node1":f3 -> "node4":f1
}
----

Что позволяет выполнить в командной строке следующие действия:


.1. Задать имя файла с экспортируемыми значениями
Ожидание ввода имени файла или пустой строки. Можно ввести имя файла, введенное значение будет использовано
вдальнейшем как файл по умолчанию. Пустой ввод не изменяет текущее значение файла по умолчанию. После ввода
значения экспорт будет выполнен и команда завершится

.2. Задать фильтр примитивов
Ожидание ввода значения фильтра примитивов по типу. <<enttypefilter_lng>>

.3. Задать фильтр свойств примитивов
Ожидание ввода значения фильтра примитивов по параметрам. <<entpropfilter_lng>>

.4. Залать скрипт экспорта
Ожидание ввода скрипта выполняющего экспорт. <<exporter_lng>>

.5. Задать имя файла в диалоговом режиме
Откроет диалог выбора файла, можно выбрать любой файл csv. Выбор файла сделает его файлом
по умолчанию и также как (1) выполнит экспорт и завершит команду

Также все это можно сделать с помошью инспектора объектов, который при выполнении команды имеет вид:

image::cmd_params_dataexport.png[width=25%,pdfwidth=25%]

[[enttypefilter_lng]]
##### Формат фильтра примитивов
Данный фильтр позволяет включить в набор или исключить из набора для экспорта определенные типы примитивов.
Включать\исключать примитивы можно как по имени, так и по маске. изначально в набор для обработки не включены
никакие примитивы. Для добавления тип примитива джолжен быть добавлен и не должен быть исключен. Фильтр
задается в текстовом виде и в общем случае выглядит так:

`Оператор(Операнд)[;Оператор(Операнд)]`

Операторы могут разделяться точкой с запятой, запятой, пробелом, переводом строки. Доступны следующие
операторы:
[cols=">3,<6"]
|======================================================
|`IncludeEntityMask`|Включить типы примитивов по маске
|`IncludeEntityName`|Включить тип примитивов по имени
|`ExcludeEntityMask`|Исключить типы примитивов по маске
|`ExcludeEntityMask`|Исключить тип примитивов по имени
|======================================================

Все операторы в качестве операнда принимают строковой параметр заключенный в апострофы.

Примеры фильтров примитивов:

Включить в экспорт примитивы *Cable* и *Device*:

`IncludeEntityName('Cable');`

`IncludeEntityName('Device')`

Включить в экспорт все типы примитивов:

`IncludeEntityMask('*')`

Включить в экспорт примитивы *PolyLine* и *Line*:

`IncludeEntityName('*Line') ExcludeEntityName('3DPolyLine')`


[[entpropfilter_lng]]
##### Формат фильтра свойств примитивов
Откроет диалог выбора файла, можно выбрать любой файл csv. Выбор файла сделает его файлом

[[exporter_lng]]
##### Формат скрипта экспорта
Откроет диалог выбора файла, можно выбрать любой файл csv. Выбор файла сделает его файлом

include::commandsummaryfree.adoc[]